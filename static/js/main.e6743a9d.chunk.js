(this["webpackJsonpwebrtc-react"]=this["webpackJsonpwebrtc-react"]||[]).push([[0],{114:function(e,t){},118:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(48),s=a.n(c),l=(a(24),a(19)),u=a.n(l),i=a(49),o=a(4),m=a(50),f=a(20),d=a.n(f),b=a(51),g=a.n(b);function v(){var e=Object(m.a)(["\n  width: 400px;\n  margin-right: 100px;\n  border: 10px solid #171a22;\n"]);return v=function(){return e},e}var p=a(52).a.video(v());var E=function(){var e=Object(n.useRef)(),t=Object(n.useRef)(!1),a=Object(n.useRef)(),c=Object(n.useRef)(),s=Object(n.useRef)(),l=Object(n.useRef)(),m=Object(n.useRef)(),f=(Object(n.useRef)(),Object(n.useRef)([])),b=Object(n.useRef)(),v=Object(n.useRef)(),E=Object(n.useState)(),O=Object(o.a)(E,2),h=O[0],j=O[1],N=Object(n.useState)(!0),w=Object(o.a)(N,2),k=w[0],y=w[1],S=Object(n.useState)(!0),R=Object(o.a)(S,2),C=R[0],x=R[1],T=Object(n.useState)(),I=Object(o.a)(T,2),A=I[0],J=I[1],B=Object(n.useState)(!1),F=Object(o.a)(B,2),P=F[0],D=F[1],M=Object(n.useState)(""),U=Object(o.a)(M,2),V=U[0],W=U[1];Object(n.useEffect)((function(){navigator.mediaDevices.getUserMedia({video:!0,audio:!0}).then((function(t){a.current&&(a.current.srcObject=t,e.current=t)})),s.current=g()("http://localhost"),b.current=prompt("What is your name, hero?"),s.current.emit("enter",b.current),s.current.on("allUsers",_),s.current.on("yourID",q),s.current.on("tryToCall",(function(e){z(e)}))}),[]);var _=function(e){J(e)},q=function(e){j(e)},z=function(){var t=Object(i.a)(u.a.mark((function t(a){var n,r,l;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=a.from,r=a.signalFromCaller,console.log("caller tries to talk with you"),(l=new d.a({initiator:!1,trickle:!1,stream:e.current,config:{iceServers:[{urls:"stun:numb.viagenie.ca",username:"sultan1640@gmail.com",credential:"98376683"},{urls:"turn:numb.viagenie.ca",username:"sultan1640@gmail.com",credential:"98376683"}]}})).on("signal",(function(e){v.current=l,s.current.emit("acceptCall",{to:n,signalFromPartner:e}),console.log("partner emits accept call")})),l.on("stream",(function(e){D(!0),c.current.srcObject=e,console.log("partner recives stream")})),l.on("data",(function(e){G(e)})),l.signal(r);case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();A&&(l.current=Object.keys(A).map((function(a){return a!==h&&r.a.createElement("li",{key:a},r.a.createElement("button",{className:"contactBtn",onClick:function(){return function(a){var n=new d.a({initiator:!0,trickle:!1,config:{iceServers:[{urls:"stun:numb.viagenie.ca",username:"sultan1640@gmail.com",credential:"98376683"},{urls:"turn:numb.viagenie.ca",username:"sultan1640@gmail.com",credential:"98376683"}]},stream:e.current});n.on("signal",(function(e){v.current=n,console.log("call started"),t.current||s.current.emit("call",{from:h,to:a,signalFromCaller:e})})),n.on("stream",(function(e){c.current.srcObject=e,console.log("recived from partner"+e)})),n.on("disconnect",(function(){console.log("closed")})),n.on("data",(function(e){G(e)})),s.current.on("callAccepted",(function(e){n.signal(e),D(!0),t.current=!0,console.log("call accepted")}))}(a)}},r.a.createElement("i",{className:"phone-icon fas fa-phone-alt"})," ",A[a]))})));var G=function(e){var t=JSON.parse(e);f.current.unshift(t);var a=f.current.map((function(e,t){return r.a.createElement("li",{key:t},r.a.createElement("div",{className:"message-body"},r.a.createElement("div",{className:"message-sender"},r.a.createElement("div",{className:"message-sender-ava"},e.user[0]),r.a.createElement("span",{className:"message-sender-name"},e.user)),r.a.createElement("div",{className:"message-content"},H(e.message))))}));W(a)},H=function(e){return K(e)?r.a.createElement("a",{href:e,target:"_blank"},e):e},K=function(e){return e.match(/^http\S+/gim)};return r.a.createElement("div",{className:"App"},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"user-media"},r.a.createElement("div",{className:"media-switchers"},r.a.createElement("button",{className:k?"switcher on":"switcher",onClick:function(){e.current.getVideoTracks()[0].enabled=!e.current.getVideoTracks()[0].enabled,y(!k)}},k?r.a.createElement("i",{className:"fas fa-video"}):r.a.createElement("i",{className:"fas fa-video-slash"})),r.a.createElement("button",{className:C?"switcher on":"switcher",onClick:function(){e.current.getAudioTracks()[0].enabled=!e.current.getAudioTracks()[0].enabled,x(!C)}},C?r.a.createElement("i",{className:"fas fa-microphone"}):r.a.createElement("i",{className:"fas fa-microphone-slash"}))),r.a.createElement(p,{playsInline:!0,ref:a,muted:!0,autoPlay:!0})),r.a.createElement("div",null,P&&r.a.createElement(p,{playsInline:!0,ref:c,autoPlay:!0}))),r.a.createElement("div",{className:"row"},r.a.createElement("ul",{className:"row contacts-list"},l.current)),P&&r.a.createElement("div",null,r.a.createElement("div",{className:"row chatInput"},r.a.createElement("input",{className:"messageTxt",type:"text",ref:m}),r.a.createElement("button",{className:"messageSendBtn",onClick:function(){var e=b.current,t=m.current.value;if(e&&t){var a=JSON.stringify({user:e,message:t});v.current.send(a),G(a),m.current.value=""}}},r.a.createElement("i",{class:"fas fa-paper-plane"}))),r.a.createElement("div",{className:"chat-thread"},r.a.createElement("ul",null,V))))};s.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(E,null)),document.getElementById("root"))},24:function(e,t,a){},56:function(e,t,a){e.exports=a(118)},85:function(e,t){},87:function(e,t){}},[[56,1,2]]]);
//# sourceMappingURL=main.e6743a9d.chunk.js.map